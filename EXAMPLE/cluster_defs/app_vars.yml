---

playbook_ca_yaml: "{{playbook_dir}}/cluster_defs/{{ cloud_type }}/{{ clusterid }}/{{ region }}/{{ buildenv }}/_ssl/ownca.yml"

osearch_version: "1.2.3"
osearch_artifact_location: "https://artifacts.opensearch.org/releases/bundle/opensearch/{{osearch_version}}/opensearch-{{osearch_version}}-linux-{{ 'x64' if ansible_architecture == 'x86_64' else 'arm64' if ansible_architecture == 'aarch64' else ansible_architecture }}.tar.gz"
osearch_user: opensearch
osearch_group: opensearch
osearch_home: "/opt/opensearch"
osearch_pid_dir: "/var/run/opensearch"
osearch_log_dir: "/var/log/opensearch"
osearch_data_dir: "/opensearch"
osearch_conf_dir: "{{osearch_home}}/config"
osearch_max_open_files: 65536
osearch_max_map_count: 262144
osearch_extra_config: {
  bootstrap.memory_lock: true,
  action.destructive_requires_name: true,
  thread_pool.search.queue_size: 10000,
  cluster.routing.allocation.disk.threshold_enabled: false,
  cluster.routing.allocation.awareness.attributes: "zone",
  http.cors.enabled: true,
  http.cors.allow-origin: "*"
}
osearch_index_codec: best_compression
osearch_index_number_of_shards: 6
osearch_index_number_of_replicas: 1
osearch_refresh_interval: "30s"
osearch_network_bind_host: 0.0.0.0
#osearch_plugins:
#  - plugin: mapper-size
#  - plugin: ingest-geoip

osearch_ssl_path: "{{ osearch_conf_dir }}"

osearch_ssl_ca_path: "{{osearch_ssl_path}}/ca-crt.pem"
osearch_ssl_crt_path: "{{osearch_ssl_path}}/opensearch-crt.pem"
osearch_ssl_key_path: "{{osearch_ssl_path}}/opensearch-key.pem"
osearch_admin_certificate: "{{osearch_ssl_path}}/admin-crt.pem"
osearch_admin_key: "{{osearch_ssl_path}}/admin-key.pem"
osearch_ssl_clientauth_mode: "OPTIONAL"      # Whether we require clients to user certificates to authenticate.  "REQUIRE", "OPTIONAL" or "NONE"

osearch_internal_users:
  admin:
    _password: "CHANGEME"
    reserved: true
    backend_roles: ["admin"]
    description: "admin user"

  kibanaserver:
    _password: "CHANGEME"
    reserved: true
    description: "kibanaserver user"

osearch_users:
  dougal:
    password: "CHANGEME"
    opendistro_security_roles: ["all_access"]
    attributes: {"name": "Dougal Seeley"}


osearch_mapping_templates:
  - name: default
    content: {
      "index_patterns": ["*"],
      "order": 0,
      "settings": {
        "index.codec": "{{osearch_index_codec}}",
        "index.number_of_shards": "{{osearch_index_number_of_shards}}",
        "index.number_of_replicas": "{{osearch_index_number_of_replicas}}",
        "index.refresh_interval": "{{osearch_refresh_interval}}",
        "index.mapping.ignore_malformed": true,
        "index.mapping.coerce": true,
        "index.mapping.total_fields.limit": 1500,
        "index.auto_expand_replicas": false
      },
      version: 1
    }


###### Dashboards ######

dashboards_version: "1.2.0"
dashboards_artifact_location: "https://artifacts.opensearch.org/releases/bundle/opensearch-dashboards/{{dashboards_version}}/opensearch-dashboards-{{dashboards_version}}-linux-{{ 'x64' if ansible_architecture == 'x86_64' else 'arm64' if ansible_architecture == 'aarch64' else ansible_architecture }}.tar.gz"
dashboards_user: "{{osearch_user}}"
dashboards_group: "{{osearch_group}}"
dashboards_home: "/opt/opensearch-dashboards"
dashboards_pid_dir: "/var/run/opensearch-dashboards"
dashboards_log_dir: "/var/log/opensearch-dashboards"
dashboards_conf_dir: "{{dashboards_home}}/config"
dashboards_network_host: 0.0.0.0
dashboards_multitenancy_enabled: true

dashboards_ssl_path: "{{ dashboards_conf_dir }}/certs"
dashboards_ssl_is_self_signed: true
dashboards_ssl_ca_path: "{{dashboards_ssl_path}}/ca-crt.pem"
dashboards_ssl_crt_path: "{{dashboards_ssl_path}}/opensearch-dashboards-crt.pem"
dashboards_ssl_key_path: "{{dashboards_ssl_path}}/opensearch-dashboards-key.pem"

#If not using self-signed certificated (should vault-encrypt the key)
dashboards_ssl_crt_content: ""
dashboards_ssl_key_content: ""